
CREATE TABLE BOOK_DETAILS (
    BOOK_ID INT PRIMARY KEY,
    TITLE VARCHAR(30) NOT NULL,
    AUTHOR VARCHAR(30) NOT NULL,
    COPIES_AVAILABLE INT CHECK (COPIES_AVAILABLE >= 1)
);

INSERT INTO BOOK_DETAILS (BOOK_ID, TITLE, AUTHOR, COPIES_AVAILABLE)
VALUES (1, 'Harry Potter', 'J K Rowling', 3);

SELECT * FROM BOOK_DETAILS;


CREATE TABLE LIBRARY_USERS (
    USER_ID INT PRIMARY KEY,
    FULL_NAME VARCHAR(25) NOT NULL,
    AGE INT NOT NULL CHECK (AGE >= 17),
    EMAIL_ID VARCHAR(40) UNIQUE
);

INSERT INTO LIBRARY_USERS
VALUES (101, 'Akash Sharma', 17, 'a@gmail.com');

SELECT * FROM LIBRARY_USERS;



CREATE TABLE BOOK_TRANSACTIONS (
    ISSUE_ID INT PRIMARY KEY,
    BOOK_ID INT NOT NULL,
    USER_ID INT NOT NULL,
    ISSUE_DATE DATE NOT NULL,
    CONSTRAINT FK_BOOK_ID
        FOREIGN KEY (BOOK_ID) REFERENCES BOOK_DETAILS(BOOK_ID),
    CONSTRAINT FK_USER_ID
        FOREIGN KEY (USER_ID) REFERENCES LIBRARY_USERS(USER_ID)
);

INSERT INTO BOOK_TRANSACTIONS
VALUES (5552, 1, 101, '2026-01-09');

SELECT * FROM BOOK_TRANSACTIONS;

CREATE ROLE LIBRARIAN_ROLE
LOGIN PASSWORD 'lib123';

GRANT SELECT, INSERT, UPDATE, DELETE
ON BOOK_DETAILS, BOOK_TRANSACTIONS, LIBRARY_USERS
TO LIBRARIAN_ROLE;

REVOKE INSERT, UPDATE, DELETE
ON BOOK_DETAILS
FROM LIBRARIAN_ROLE;
